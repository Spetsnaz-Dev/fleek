worker-1   | sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
worker-1   | [SQL: SELECT job.id AS job_id, job.prompt AS job_prompt, job.parameters AS job_parameters, job.status AS job_status, job.result_url AS job_result_url, job.error_message AS job_error_message, job.created_at AS job_created_at, job.started_at AS job_started_at, job.finished_at AS job_finished_at, job.retry_attempts AS job_retry_attempts 
worker-1   | FROM job 
worker-1   | WHERE job.id = $1::INTEGER]
worker-1   | [parameters: (4,)]
worker-1   | (Background on this error at: https://sqlalche.me/e/20/rvf5)
worker-1   | [2025-07-25 08:28:31,019] [PID 14] [Thread-11] [dramatiq.middleware.retries.Retries] [INFO] Retrying message '1eb3477f-cdee-4586-95c2-cabba85a51ae' in 34686 milliseconds.
backend-1  | 2025-07-25 08:28:37,124 INFO sqlalchemy.engine.Engine BEGIN (implicit)
backend-1  | 2025-07-25 08:28:37,124 INFO sqlalchemy.engine.Engine SELECT job.id AS job_id, job.prompt AS job_prompt, job.parameters AS job_parameters, job.status AS job_status, job.result_url AS job_result_url, job.error_message AS job_error_message, job.created_at AS job_created_at, job.started_at AS job_started_at, job.finished_at AS job_finished_at, job.retry_attempts AS job_retry_attempts 
backend-1  | FROM job 
backend-1  | WHERE job.id = $1::INTEGER
backend-1  | 2025-07-25 08:28:37,124 INFO sqlalchemy.engine.Engine [cached since 68.31s ago] (4,)
backend-1  | 2025-07-25 08:28:37,125 INFO sqlalchemy.engine.Engine ROLLBACK
backend-1  | INFO:     172.18.0.1:47934 - "GET /status/4 HTTP/1.1" 200 OK
worker-1   | 2025-07-25 08:28:40,262 INFO sqlalchemy.engine.Engine select pg_catalog.version()
worker-1   | [2025-07-25 08:28:40,262] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] select pg_catalog.version()
worker-1   | 2025-07-25 08:28:40,263 INFO sqlalchemy.engine.Engine [raw sql] ()
worker-1   | [2025-07-25 08:28:40,263] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] [raw sql] ()
worker-1   | 2025-07-25 08:28:40,264 INFO sqlalchemy.engine.Engine select current_schema()
worker-1   | [2025-07-25 08:28:40,264] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] select current_schema()
worker-1   | 2025-07-25 08:28:40,264 INFO sqlalchemy.engine.Engine [raw sql] ()
worker-1   | [2025-07-25 08:28:40,264] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] [raw sql] ()
worker-1   | 2025-07-25 08:28:40,265 INFO sqlalchemy.engine.Engine show standard_conforming_strings
worker-1   | [2025-07-25 08:28:40,265] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] show standard_conforming_strings
worker-1   | 2025-07-25 08:28:40,265 INFO sqlalchemy.engine.Engine [raw sql] ()
worker-1   | [2025-07-25 08:28:40,265] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] [raw sql] ()
worker-1   | 2025-07-25 08:28:40,266 INFO sqlalchemy.engine.Engine BEGIN (implicit)
worker-1   | [2025-07-25 08:28:40,266] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] BEGIN (implicit)
worker-1   | 2025-07-25 08:28:40,272 INFO sqlalchemy.engine.Engine SELECT job.id AS job_id, job.prompt AS job_prompt, job.parameters AS job_parameters, job.status AS job_status, job.result_url AS job_result_url, job.error_message AS job_error_message, job.created_at AS job_created_at, job.started_at AS job_started_at, job.finished_at AS job_finished_at, job.retry_attempts AS job_retry_attempts 
worker-1   | FROM job 
worker-1   | WHERE job.id = $1::INTEGER
worker-1   | [2025-07-25 08:28:40,272] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] SELECT job.id AS job_id, job.prompt AS job_prompt, job.parameters AS job_parameters, job.status AS job_status, job.result_url AS job_result_url, job.error_message AS job_error_message, job.created_at AS job_created_at, job.started_at AS job_started_at, job.finished_at AS job_finished_at, job.retry_attempts AS job_retry_attempts 
worker-1   | FROM job 
worker-1   | WHERE job.id = $1::INTEGER
worker-1   | 2025-07-25 08:28:40,272 INFO sqlalchemy.engine.Engine [generated in 0.00018s] (5,)
worker-1   | [2025-07-25 08:28:40,272] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] [generated in 0.00018s] (5,)
worker-1   | 2025-07-25 08:28:40,275 INFO sqlalchemy.engine.Engine UPDATE job SET status=$1::VARCHAR, started_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE job.id = $3::INTEGER
worker-1   | [2025-07-25 08:28:40,275] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] UPDATE job SET status=$1::VARCHAR, started_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE job.id = $3::INTEGER
worker-1   | 2025-07-25 08:28:40,276 INFO sqlalchemy.engine.Engine [generated in 0.00019s] ('in_progress', datetime.datetime(2025, 7, 25, 8, 28, 40, 274100), 5)
worker-1   | [2025-07-25 08:28:40,276] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] [generated in 0.00019s] ('in_progress', datetime.datetime(2025, 7, 25, 8, 28, 40, 274100), 5)
worker-1   | 2025-07-25 08:28:40,277 INFO sqlalchemy.engine.Engine COMMIT
worker-1   | [2025-07-25 08:28:40,277] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] COMMIT
worker-1   | [2025-07-25 08:28:43,970] [PID 8] [Thread-11] [httpx] [INFO] HTTP Request: GET https://picsum.photos/200 "HTTP/1.1 302 Found"
worker-1   | [2025-07-25 08:28:44,021] [PID 8] [Thread-11] [httpx] [INFO] HTTP Request: GET https://fastly.picsum.photos/id/135/200/200.jpg?hmac=uaxfwtA3aJhzzHN36hg2MJi5Rl8nbuqAsipKDDj2seU "HTTP/1.1 200 OK"
worker-1   | 2025-07-25 08:28:44,022 INFO sqlalchemy.engine.Engine BEGIN (implicit)
worker-1   | [2025-07-25 08:28:44,022] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] BEGIN (implicit)
worker-1   | 2025-07-25 08:28:44,023 INFO sqlalchemy.engine.Engine UPDATE job SET status=$1::VARCHAR, result_url=$2::VARCHAR, finished_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE job.id = $4::INTEGER
worker-1   | [2025-07-25 08:28:44,023] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] UPDATE job SET status=$1::VARCHAR, result_url=$2::VARCHAR, finished_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE job.id = $4::INTEGER
worker-1   | 2025-07-25 08:28:44,023 INFO sqlalchemy.engine.Engine [generated in 0.00023s] ('completed', 'media/5_output.png', datetime.datetime(2025, 7, 25, 8, 28, 44, 22090), 5)
worker-1   | [2025-07-25 08:28:44,023] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] [generated in 0.00023s] ('completed', 'media/5_output.png', datetime.datetime(2025, 7, 25, 8, 28, 44, 22090), 5)
worker-1   | 2025-07-25 08:28:44,024 INFO sqlalchemy.engine.Engine COMMIT
worker-1   | [2025-07-25 08:28:44,024] [PID 8] [Thread-11] [sqlalchemy.engine.Engine] [INFO] COMMIT
backend-1  | 2025-07-25 08:28:52,294 INFO sqlalchemy.engine.Engine BEGIN (implicit)
backend-1  | 2025-07-25 08:28:52,294 INFO sqlalchemy.engine.Engine SELECT job.id AS job_id, job.prompt AS job_prompt, job.parameters AS job_parameters, job.status AS job_status, job.result_url AS job_result_url, job.error_message AS job_error_message, job.created_at AS job_created_at, job.started_at AS job_started_at, job.finished_at AS job_finished_at, job.retry_attempts AS job_retry_attempts 
backend-1  | FROM job 
backend-1  | WHERE job.id = $1::INTEGER
backend-1  | 2025-07-25 08:28:52,294 INFO sqlalchemy.engine.Engine [cached since 83.49s ago] (4,)
backend-1  | 2025-07-25 08:28:52,295 INFO sqlalchemy.engine.Engine ROLLBACK
backend-1  | INFO:     172.18.0.1:49284 - "GET /status/4 HTTP/1.1" 200 OK
worker-1   | 2025-07-25 08:29:06,503 INFO sqlalchemy.engine.Engine select pg_catalog.version()
worker-1   | [2025-07-25 08:29:06,503] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] select pg_catalog.version()
worker-1   | 2025-07-25 08:29:06,503 INFO sqlalchemy.engine.Engine [raw sql] ()
worker-1   | [2025-07-25 08:29:06,503] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] [raw sql] ()
worker-1   | 2025-07-25 08:29:06,505 INFO sqlalchemy.engine.Engine select current_schema()
worker-1   | [2025-07-25 08:29:06,505] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] select current_schema()
worker-1   | 2025-07-25 08:29:06,505 INFO sqlalchemy.engine.Engine [raw sql] ()
worker-1   | [2025-07-25 08:29:06,505] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] [raw sql] ()
worker-1   | 2025-07-25 08:29:06,506 INFO sqlalchemy.engine.Engine show standard_conforming_strings
worker-1   | [2025-07-25 08:29:06,506] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] show standard_conforming_strings
worker-1   | 2025-07-25 08:29:06,506 INFO sqlalchemy.engine.Engine [raw sql] ()
worker-1   | [2025-07-25 08:29:06,506] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] [raw sql] ()
worker-1   | 2025-07-25 08:29:06,506 INFO sqlalchemy.engine.Engine BEGIN (implicit)
worker-1   | [2025-07-25 08:29:06,506] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] BEGIN (implicit)
worker-1   | 2025-07-25 08:29:06,509 INFO sqlalchemy.engine.Engine SELECT job.id AS job_id, job.prompt AS job_prompt, job.parameters AS job_parameters, job.status AS job_status, job.result_url AS job_result_url, job.error_message AS job_error_message, job.created_at AS job_created_at, job.started_at AS job_started_at, job.finished_at AS job_finished_at, job.retry_attempts AS job_retry_attempts 
worker-1   | FROM job 
worker-1   | WHERE job.id = $1::INTEGER
worker-1   | [2025-07-25 08:29:06,509] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] SELECT job.id AS job_id, job.prompt AS job_prompt, job.parameters AS job_parameters, job.status AS job_status, job.result_url AS job_result_url, job.error_message AS job_error_message, job.created_at AS job_created_at, job.started_at AS job_started_at, job.finished_at AS job_finished_at, job.retry_attempts AS job_retry_attempts 
worker-1   | FROM job 
worker-1   | WHERE job.id = $1::INTEGER
worker-1   | 2025-07-25 08:29:06,509 INFO sqlalchemy.engine.Engine [generated in 0.00013s] (4,)
worker-1   | [2025-07-25 08:29:06,509] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] [generated in 0.00013s] (4,)
worker-1   | 2025-07-25 08:29:06,513 INFO sqlalchemy.engine.Engine UPDATE job SET status=$1::VARCHAR, started_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE job.id = $3::INTEGER
worker-1   | [2025-07-25 08:29:06,513] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] UPDATE job SET status=$1::VARCHAR, started_at=$2::TIMESTAMP WITHOUT TIME ZONE WHERE job.id = $3::INTEGER
worker-1   | 2025-07-25 08:29:06,513 INFO sqlalchemy.engine.Engine [generated in 0.00019s] ('in_progress', datetime.datetime(2025, 7, 25, 8, 29, 6, 511402), 4)
worker-1   | [2025-07-25 08:29:06,513] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] [generated in 0.00019s] ('in_progress', datetime.datetime(2025, 7, 25, 8, 29, 6, 511402), 4)
worker-1   | 2025-07-25 08:29:06,514 INFO sqlalchemy.engine.Engine COMMIT
worker-1   | [2025-07-25 08:29:06,514] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] COMMIT
worker-1   | [2025-07-25 08:29:09,570] [PID 12] [Thread-10] [httpx] [INFO] HTTP Request: GET https://picsum.photos/200 "HTTP/1.1 302 Found"
worker-1   | [2025-07-25 08:29:09,621] [PID 12] [Thread-10] [httpx] [INFO] HTTP Request: GET https://fastly.picsum.photos/id/416/200/200.jpg?hmac=QgMiXqHqKofoCv4h8lkrwRSOkn5Twkh15Dfl9Efvtwo "HTTP/1.1 200 OK"
worker-1   | 2025-07-25 08:29:09,624 INFO sqlalchemy.engine.Engine BEGIN (implicit)
worker-1   | [2025-07-25 08:29:09,624] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] BEGIN (implicit)
worker-1   | 2025-07-25 08:29:09,625 INFO sqlalchemy.engine.Engine UPDATE job SET status=$1::VARCHAR, result_url=$2::VARCHAR, finished_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE job.id = $4::INTEGER
worker-1   | [2025-07-25 08:29:09,625] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] UPDATE job SET status=$1::VARCHAR, result_url=$2::VARCHAR, finished_at=$3::TIMESTAMP WITHOUT TIME ZONE WHERE job.id = $4::INTEGER
worker-1   | 2025-07-25 08:29:09,625 INFO sqlalchemy.engine.Engine [generated in 0.00021s] ('completed', 'media/4_output.png', datetime.datetime(2025, 7, 25, 8, 29, 9, 623725), 4)
worker-1   | [2025-07-25 08:29:09,625] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] [generated in 0.00021s] ('completed', 'media/4_output.png', datetime.datetime(2025, 7, 25, 8, 29, 9, 623725), 4)
worker-1   | 2025-07-25 08:29:09,628 INFO sqlalchemy.engine.Engine COMMIT
worker-1   | [2025-07-25 08:29:09,628] [PID 12] [Thread-10] [sqlalchemy.engine.Engine] [INFO] COMMIT
backend-1  | 2025-07-25 08:29:10,060 INFO sqlalchemy.engine.Engine BEGIN (implicit)
backend-1  | 2025-07-25 08:29:10,060 INFO sqlalchemy.engine.Engine SELECT job.id AS job_id, job.prompt AS job_prompt, job.parameters AS job_parameters, job.status AS job_status, job.result_url AS job_result_url, job.error_message AS job_error_message, job.created_at AS job_created_at, job.started_at AS job_started_at, job.finished_at AS job_finished_at, job.retry_attempts AS job_retry_attempts 
backend-1  | FROM job 
backend-1  | WHERE job.id = $1::INTEGER
backend-1  | 2025-07-25 08:29:10,060 INFO sqlalchemy.engine.Engine [cached since 101.3s ago] (4,)
backend-1  | 2025-07-25 08:29:10,061 INFO sqlalchemy.engine.Engine ROLLBACK
backend-1  | INFO:     172.18.0.1:34766 - "GET /status/4 HTTP/1.1" 200 OK
